{"ast":null,"code":"import React,{useState}from\"react\";import\"./registration.css\";import{Link}from\"react-router-dom\";import Header from\"../../components/header/Header\";import{fetchRegister,selectIsAuth}from\"../../redux/slices/auth\";import{useDispatch,useSelector}from\"react-redux\";import{Navigate}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export const Registration=()=>{const isAuth=useSelector(selectIsAuth);const dispatch=useDispatch();// Локальное состояние для управления отображением ошибок\nconst[showErrors,setShowErrors]=useState(false);const{register,handleSubmit,watch,formState:{errors,isValid}}=useForm({defaultValues:{fullName:\"\",email:\"\",password:\"\",confirmPassword:\"\",changeInput:\"\"},mode:\"onSubmit\"// Ошибки показываются после попытки сабмита\n});const onSubmit=async values=>{const data=await dispatch(fetchRegister(values));if(!data.payload){return alert(\"Не удалось зарегистрироваться\");}if(\"token\"in data.payload){window.localStorage.setItem(\"token\",data.payload.token);}};if(isAuth){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}const password=watch(\"password\");const handleFormSubmit=data=>{setShowErrors(true);// Включаем отображение ошибок после клика\nhandleSubmit(onSubmit)(data);// Вызываем отправку формы\n};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"section\",{className:\"Login\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"preview\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-center\",children:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"registration-cssave\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(handleFormSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-item\",type:\"text\",placeholder:\"\\u041B\\u043E\\u0433\\u0438\\u043D\",...register(\"fullName\",{required:\"Введите логин\",minLength:{value:4,message:\"Минимум 4 символа\"},maxLength:{value:15,message:\"Максимум 15 символов\"}})}),showErrors&&errors.fullName&&/*#__PURE__*/_jsx(\"p\",{className:\"check\",children:errors.fullName.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-item\",type:\"email\",placeholder:\"Email\",...register(\"email\",{required:\"Введите почту\",pattern:{value:/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,message:\"Введите корректный email\"}})}),showErrors&&errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"check\",children:errors.email.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-item\",type:\"password\",placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",...register(\"password\",{required:\"Введите пароль\",minLength:{value:6,message:\"Минимум 6 символов\"}})}),showErrors&&errors.password&&/*#__PURE__*/_jsx(\"p\",{className:\"check\",children:errors.password.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control-item\",type:\"password\",placeholder:\"\\u041F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u0435 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",...register(\"confirmPassword\",{required:\"Подтвердите пароль\",validate:value=>value===password||\"Пароли не совпадают\"})}),showErrors&&errors.confirmPassword&&/*#__PURE__*/_jsx(\"p\",{className:\"check\",children:errors.confirmPassword.message})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-block create-account\",type:\"button\",onClick:handleFormSubmit// Вызываем сабмит с отображением ошибок\n,children:\"\\u0421\\u041E\\u0417\\u0414\\u0410\\u0422\\u042C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"log-in\",type:\"button\",children:[\"\\u0415\\u0441\\u0442\\u044C \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442? \",/*#__PURE__*/_jsx(\"a\",{children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})})})]})})]})})]});};export default Registration;","map":{"version":3,"names":["React","useState","Link","Header","fetchRegister","selectIsAuth","useDispatch","useSelector","Navigate","useForm","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Registration","isAuth","dispatch","showErrors","setShowErrors","register","handleSubmit","watch","formState","errors","isValid","defaultValues","fullName","email","password","confirmPassword","changeInput","mode","onSubmit","values","data","payload","alert","window","localStorage","setItem","token","to","handleFormSubmit","children","className","type","placeholder","required","minLength","value","message","maxLength","pattern","validate","onClick"],"sources":["C:/Users/lakir/Desktop/lastTry/frontend/src/pages/registration/Registration.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport \"./registration.css\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Header from \"../../components/header/Header\";\r\nimport { fetchRegister, selectIsAuth } from \"../../redux/slices/auth\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Navigate } from \"react-router-dom\";\r\nimport { useForm } from \"react-hook-form\";\r\n\r\nexport const Registration = () => {\r\n  const isAuth = useSelector(selectIsAuth);\r\n  const dispatch = useDispatch();\r\n\r\n  // Локальное состояние для управления отображением ошибок\r\n  const [showErrors, setShowErrors] = useState(false);\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    watch,\r\n    formState: { errors, isValid },\r\n  } = useForm({\r\n    defaultValues: {\r\n      fullName: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n      confirmPassword: \"\",\r\n      changeInput: \"\",\r\n    },\r\n    mode: \"onSubmit\", // Ошибки показываются после попытки сабмита\r\n  });\r\n\r\n  const onSubmit = async (values) => {\r\n    const data = await dispatch(fetchRegister(values));\r\n    if (!data.payload) {\r\n      return alert(\"Не удалось зарегистрироваться\");\r\n    }\r\n    if (\"token\" in data.payload) {\r\n      window.localStorage.setItem(\"token\", data.payload.token);\r\n    }\r\n  };\r\n\r\n  if (isAuth) {\r\n    return <Navigate to=\"/\" />;\r\n  }\r\n\r\n  const password = watch(\"password\");\r\n\r\n  const handleFormSubmit = (data) => {\r\n    setShowErrors(true); // Включаем отображение ошибок после клика\r\n    handleSubmit(onSubmit)(data); // Вызываем отправку формы\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Header />\r\n      <section className=\"Login\">\r\n        <div className=\"preview\">\r\n          <h3 className=\"text-center\">Регистрация</h3>\r\n          <div className=\"registration-cssave\">\r\n            <form onSubmit={handleSubmit(handleFormSubmit)}>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  className=\"form-control-item\"\r\n                  type=\"text\"\r\n                  placeholder=\"Логин\"\r\n                  {...register(\"fullName\", {\r\n                    required: \"Введите логин\",\r\n                    minLength: { value: 4, message: \"Минимум 4 символа\" },\r\n                    maxLength: { value: 15, message: \"Максимум 15 символов\" },\r\n                  })}\r\n                />\r\n                {showErrors && errors.fullName && <p className=\"check\">{errors.fullName.message}</p>}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input \r\n                  className=\"form-control-item\"\r\n                  type=\"email\"\r\n                  placeholder=\"Email\"\r\n                  {...register(\"email\", { \r\n                    required: \"Введите почту\",\r\n                    pattern: {\r\n                      value: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\r\n                      message: \"Введите корректный email\",\r\n                    },\r\n                  })}\r\n                />\r\n                {showErrors && errors.email && <p className=\"check\">{errors.email.message}</p>}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input \r\n                  className=\"form-control-item\"\r\n                  type=\"password\"\r\n                  placeholder=\"Пароль\"\r\n                  {...register(\"password\", {\r\n                    required: \"Введите пароль\",\r\n                    minLength: { value: 6, message: \"Минимум 6 символов\" },\r\n                  })}\r\n                />\r\n                {showErrors && errors.password && <p className=\"check\">{errors.password.message}</p>}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <input\r\n                  className=\"form-control-item\"\r\n                  type=\"password\"\r\n                  placeholder=\"Повторите пароль\"\r\n                  \r\n                  {...register(\"confirmPassword\", {\r\n                    \r\n                    required: \"Подтвердите пароль\",\r\n                    validate: (value) =>\r\n                      value === password || \"Пароли не совпадают\",\r\n                  })}\r\n                />\r\n                {showErrors && errors.confirmPassword && (\r\n                  <p className=\"check\">{errors.confirmPassword.message}</p>\r\n                )}\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <button\r\n                  className=\"btn btn-primary btn-block create-account\"\r\n                  type=\"button\"\r\n                  onClick={handleFormSubmit} // Вызываем сабмит с отображением ошибок\r\n                >\r\n                  СОЗДАТЬ\r\n                </button>\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <Link to=\"/login\">\r\n                  <button className=\"log-in\" type=\"button\">\r\n                    Есть аккаунт? <a>Войти</a>\r\n                  </button>\r\n                </Link>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Registration;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}